{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/ASUS/Documents/React/MERN-E/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/ASUS/Documents/React/MERN-E/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/ASUS/Documents/React/MERN-E/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{createContext,useState,useEffect}from'react';import axios from'axios';import ProductsAPI from'./api/ProductsAPI';import UserAPI from'./api/UserAPI';import CategoriesAPI from'./api/CategoriesAPI';import{jsx as _jsx}from\"react/jsx-runtime\";export var GlobalState=/*#__PURE__*/createContext();export var DataProvider=function DataProvider(_ref){var children=_ref.children;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];useEffect(function(){var login=localStorage.getItem('Login');if(login){var refreshToken=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/user/refresh_token');case 2:res=_context.sent;setToken(res.data.accesstoken);setTimeout(function(){refreshToken();},10*60*1000);case 5:case\"end\":return _context.stop();}}},_callee);}));return function refreshToken(){return _ref2.apply(this,arguments);};}();refreshToken();}},[]);var state={token:[token,setToken],productsAPI:ProductsAPI(),userAPI:UserAPI(token),categoryAPI:CategoriesAPI(token)};return/*#__PURE__*/_jsx(GlobalState.Provider,{value:state,children:children});};","map":{"version":3,"sources":["C:/Users/ASUS/Documents/React/MERN-E/client/src/GlobalState.js"],"names":["React","createContext","useState","useEffect","axios","ProductsAPI","UserAPI","CategoriesAPI","GlobalState","DataProvider","children","token","setToken","login","localStorage","getItem","refreshToken","get","res","data","accesstoken","setTimeout","state","productsAPI","userAPI","categoryAPI"],"mappings":"meAAA,MAAOA,CAAAA,KAAP,EAAgBC,aAAhB,CAA+BC,QAA/B,CAAyCC,SAAzC,KAA0D,OAA1D,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,MAAOC,CAAAA,WAAP,KAAwB,mBAAxB,CACA,MAAOC,CAAAA,OAAP,KAAoB,eAApB,CACA,MAAOC,CAAAA,aAAP,KAA0B,qBAA1B,C,2CAEA,MAAO,IAAMC,CAAAA,WAAW,cAAGP,aAAa,EAAjC,CAEP,MAAO,IAAMQ,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAAgB,IAAdC,CAAAA,QAAc,MAAdA,QAAc,eAChBR,QAAQ,CAAC,KAAD,CADQ,wCACnCS,KADmC,eAC5BC,QAD4B,eAG1CT,SAAS,CAAC,UAAM,CACd,GAAMU,CAAAA,KAAK,CAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd,CACA,GAAIF,KAAJ,CAAW,CACT,GAAMG,CAAAA,YAAY,2FAAG,iKACDZ,CAAAA,KAAK,CAACa,GAAN,CAAU,qBAAV,CADC,QACbC,GADa,eAEnBN,QAAQ,CAACM,GAAG,CAACC,IAAJ,CAASC,WAAV,CAAR,CAEAC,UAAU,CAAC,UAAM,CACfL,YAAY,GACb,CAFS,CAEP,GAAK,EAAL,CAAU,IAFH,CAAV,CAJmB,sDAAH,kBAAZA,CAAAA,YAAY,2CAAlB,CAQAA,YAAY,GACb,CACF,CAbQ,CAaN,EAbM,CAAT,CAeA,GAAMM,CAAAA,KAAK,CAAG,CACZX,KAAK,CAAE,CAACA,KAAD,CAAQC,QAAR,CADK,CAEZW,WAAW,CAAElB,WAAW,EAFZ,CAGZmB,OAAO,CAAElB,OAAO,CAACK,KAAD,CAHJ,CAIZc,WAAW,CAAElB,aAAa,CAACI,KAAD,CAJd,CAAd,CAOA,mBACE,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAEW,KAA7B,UACGZ,QADH,EADF,CAKD,CA9BM","sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\n\r\nimport ProductsAPI from './api/ProductsAPI';\r\nimport UserAPI from './api/UserAPI';\r\nimport CategoriesAPI from './api/CategoriesAPI';\r\n\r\nexport const GlobalState = createContext()\r\n\r\nexport const DataProvider = ({children}) => {\r\n  const [token, setToken] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const login = localStorage.getItem('Login')\r\n    if (login) {\r\n      const refreshToken = async () => {\r\n        const res = await axios.get('/user/refresh_token', )\r\n        setToken(res.data.accesstoken)\r\n        \r\n        setTimeout(() => {\r\n          refreshToken()\r\n        }, 10 * 60 * 1000)\r\n      }\r\n      refreshToken()\r\n    }\r\n  }, [])\r\n  \r\n  const state = {\r\n    token: [token, setToken],\r\n    productsAPI: ProductsAPI(),\r\n    userAPI: UserAPI(token),\r\n    categoryAPI: CategoriesAPI(token)\r\n  }\r\n\r\n  return (\r\n    <GlobalState.Provider value={state}>\r\n      {children}\r\n    </GlobalState.Provider>\r\n  )\r\n}"]},"metadata":{},"sourceType":"module"}