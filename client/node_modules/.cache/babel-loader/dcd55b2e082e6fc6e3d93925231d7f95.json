{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Documents\\\\React\\\\MERN-E\\\\client\\\\src\\\\components\\\\mainpage\\\\admin\\\\create-product\\\\CreateProduct.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport swal from 'sweetalert';\nimport { useHistory, useParams } from 'react-router-dom';\nimport { GlobalState } from '../../../../GlobalState';\nimport Loading from '../../utils/loading/Loading';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  product_id: '',\n  title: '',\n  price: 0,\n  description: '',\n  content: '',\n  category: '',\n  _id: ''\n};\n\nconst CreateProduct = () => {\n  _s();\n\n  const state = useContext(GlobalState);\n  const [token] = state.token;\n  const [products] = state.productsAPI.products;\n  const [categories] = state.categoryAPI.categories;\n  const [callback, setCallback] = state.productsAPI.callback;\n  const [isAdmin] = state.userAPI.isAdmin;\n  const [product, setProduct] = useState(initialState);\n  const [images, setImages] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [edit, setEdit] = useState(false);\n  const params = useParams();\n  const history = useHistory();\n  useEffect(() => {\n    if (params.id) {\n      setEdit(true);\n      products.forEach(product => {\n        if (product._id === params.id) {\n          setProduct(product);\n          setImages(product.images);\n        }\n      });\n    } else {\n      setEdit(false);\n      setProduct(initialState);\n      setImages(false);\n    }\n  }, [params, products]);\n  const styleUpload = {\n    display: images ? \"block\" : \"none\"\n  };\n\n  const handleUpload = async e => {\n    e.preventDefault();\n\n    try {\n      if (!isAdmin) return swal(\"Error\", \"You're not an admin.\", \"error\");\n      const file = e.target.files[0];\n      if (!file) return swal(\"Error\", \"File not exist.\", \"error\");\n      if (file.size > 1024 * 1024) return swal(\"Error\", \"Size too large.\", \"error\");\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png') return swal(\"Error\", \"File format is incorrect.\", \"error\");\n      let formData = new FormData();\n      formData.append('file', file);\n      setLoading(true);\n      const res = await axios.post('/api/upload', formData, {\n        headers: {\n          'content-type': 'multipart/form-data',\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      setImages(res.data);\n    } catch (err) {\n      swal(\"Error\", err.response.data.msg, \"error\");\n    }\n  };\n\n  const handleDestroy = async e => {\n    try {\n      if (!isAdmin) return swal(\"Error\", \"You're not an admin.\", \"error\");\n      setLoading(true);\n      await axios.post('/api/destroy', {\n        public_id: images.public_id\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      setLoading(false);\n      setImages(false);\n    } catch (err) {\n      swal(\"Error\", err.response.data.msg, \"error\");\n    }\n  };\n\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setProduct({ ...product,\n      [name]: value\n    });\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    try {\n      if (!isAdmin) return swal(\"Error\", \"You're not an admin.\", \"error\");\n      if (!images) return swal(\"Error\", \"No image upload.\", \"error\");\n\n      if (edit) {\n        await axios.put(`/api/products/${product._id}`, { ...product,\n          images\n        }, {\n          headers: {\n            Authorization: token\n          }\n        });\n      } else {\n        await axios.post('/api/products', { ...product,\n          images\n        }, {\n          headers: {\n            Authorization: token\n          }\n        });\n      }\n\n      setCallback(!callback);\n      history.push('/admin/create-product');\n    } catch (err) {\n      swal(\"Error\", err.response.data.msg, \"error\");\n    }\n  };\n\n  const deleteProduct = async (id, public_id) => {\n    try {\n      setLoading(true);\n      const destroyImg = axios.post('/api/destroy', {\n        public_id\n      }, {\n        headers: {\n          Authorization: token\n        }\n      });\n      const deleteProduct = axios.delete(`/api/products/${id}`, {\n        headers: {\n          Authorization: token\n        }\n      });\n      await destroyImg;\n      await deleteProduct;\n      setCallback(!callback);\n      setLoading(false);\n    } catch (err) {\n      swal(\"Error\", err.response.data.msg, \"error\");\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"checkbox\",\n      id: \"sidebar-toggle\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sidebar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"brand\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ti-unlink\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"ADMIN\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"sidebar-toggle\",\n          className: \"ti-menu-alt\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sidebar-menu\",\n        children: /*#__PURE__*/_jsxDEV(\"ul\", {\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/admin\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ti-home\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 157,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Home\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 158,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/admin/create-product\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ti-face-smile\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 163,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Create Product\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 164,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 161,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"/admin/create-category\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ti-agenda\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 169,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Create Category\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 170,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 168,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"!#\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ti-clipboard\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 175,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Leaves\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 176,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"!#\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ti-folder\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 181,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Projects\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"!#\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ti-time\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 187,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Timesheet\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 188,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 186,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"!#\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ti-book\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Contacts\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 194,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: \"!#\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ti-settings\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 199,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: \"Account\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 200,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 198,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-content\",\n      children: /*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"admin-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"search-wrapper\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ti-search\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"search\",\n            placeholder: \"Search\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 211,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"social-icons\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ti-bell\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"ti-comment\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 142,\n    columnNumber: 5\n  }, this);\n};\n\n_s(CreateProduct, \"nLyboKAhyGpuM4pKvwCyXLoWWAA=\", false, function () {\n  return [useParams, useHistory];\n});\n\n_c = CreateProduct;\nexport default CreateProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreateProduct\");","map":{"version":3,"sources":["C:/Users/ASUS/Documents/React/MERN-E/client/src/components/mainpage/admin/create-product/CreateProduct.js"],"names":["React","useState","useContext","useEffect","Link","axios","swal","useHistory","useParams","GlobalState","Loading","initialState","product_id","title","price","description","content","category","_id","CreateProduct","state","token","products","productsAPI","categories","categoryAPI","callback","setCallback","isAdmin","userAPI","product","setProduct","images","setImages","loading","setLoading","edit","setEdit","params","history","id","forEach","styleUpload","display","handleUpload","e","preventDefault","file","target","files","size","type","formData","FormData","append","res","post","headers","Authorization","data","err","response","msg","handleDestroy","public_id","handleChange","name","value","handleSubmit","put","push","deleteProduct","destroyImg","delete"],"mappings":"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","sourcesContent":["import React, { useState, useContext, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport swal from 'sweetalert';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\n\r\nimport { GlobalState } from '../../../../GlobalState';\r\nimport Loading from '../../utils/loading/Loading';\r\n\r\nconst initialState = {\r\n  product_id: '',\r\n  title: '',\r\n  price: 0,\r\n  description: '',\r\n  content: '',\r\n  category: '',\r\n  _id: ''\r\n};\r\n\r\nconst CreateProduct = () => {\r\n  const state = useContext(GlobalState);\r\n  const [token] = state.token;\r\n  const [products] = state.productsAPI.products;\r\n  const [categories] = state.categoryAPI.categories;\r\n  const [callback, setCallback] = state.productsAPI.callback;\r\n  const [isAdmin] = state.userAPI.isAdmin;\r\n\r\n  const [product, setProduct] = useState(initialState);\r\n  const [images, setImages] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const [edit, setEdit] = useState(false);\r\n\r\n  const params = useParams();\r\n  const history = useHistory();\r\n\r\n  useEffect(() => {\r\n    if (params.id) {\r\n      setEdit(true)\r\n      products.forEach(product => {\r\n        if (product._id === params.id) {\r\n          setProduct(product)\r\n          setImages(product.images)\r\n        }    \r\n      })\r\n    } else {\r\n      setEdit(false)\r\n      setProduct(initialState)\r\n      setImages(false)\r\n    }\r\n  }, [params, products])\r\n\r\n  const styleUpload = {\r\n    display: images ? \"block\" : \"none\"\r\n  }\r\n\r\n  const handleUpload = async (e) => {\r\n    e.preventDefault()\r\n    try {\r\n      if (!isAdmin) return swal(\"Error\", \"You're not an admin.\", \"error\")\r\n      const file = e.target.files[0]\r\n\r\n      if (!file) return swal(\"Error\", \"File not exist.\", \"error\")\r\n      if (file.size > 1024 * 1024) return swal(\"Error\", \"Size too large.\", \"error\")\r\n      if (file.type !== 'image/jpeg' && file.type !== 'image/png') return swal(\"Error\", \"File format is incorrect.\", \"error\")\r\n\r\n      let formData = new FormData()\r\n      formData.append('file', file)\r\n\r\n      setLoading(true)\r\n      const res = await axios.post('/api/upload', formData, {\r\n        headers: {'content-type': 'multipart/form-data', Authorization: token}\r\n      })\r\n      setLoading(false)\r\n      setImages(res.data)\r\n    } catch (err) {\r\n      swal(\"Error\", err.response.data.msg, \"error\")\r\n    }\r\n  }\r\n\r\n  const handleDestroy = async (e) => {\r\n    try {\r\n      if (!isAdmin) return swal(\"Error\", \"You're not an admin.\", \"error\")\r\n      setLoading(true)\r\n      await axios.post('/api/destroy', {public_id: images.public_id}, {\r\n        headers: {Authorization: token}\r\n      })\r\n      setLoading(false)\r\n      setImages(false)\r\n    } catch (err) {\r\n      swal(\"Error\", err.response.data.msg, \"error\")\r\n    }\r\n  }\r\n\r\n  const handleChange = (e) => {\r\n    const {name, value} = e.target\r\n    setProduct({...product, [name]: value})\r\n  }\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault()\r\n    try {\r\n      if (!isAdmin) return swal(\"Error\", \"You're not an admin.\", \"error\")\r\n      if (!images) return swal(\"Error\", \"No image upload.\", \"error\")  \r\n      \r\n      if (edit) {\r\n        await axios.put(`/api/products/${product._id}`, {...product, images}, {\r\n          headers: {Authorization: token}\r\n        })\r\n      } else {\r\n        await axios.post('/api/products', {...product, images}, {\r\n          headers: {Authorization: token}\r\n        })  \r\n      }\r\n      setCallback(!callback)\r\n      history.push('/admin/create-product')\r\n    } catch (err) {\r\n      swal(\"Error\", err.response.data.msg, \"error\")\r\n    }\r\n  }\r\n\r\n  const deleteProduct = async (id, public_id) => {\r\n    try {\r\n      setLoading(true)\r\n      const destroyImg = axios.post('/api/destroy', {public_id}, {\r\n        headers: {Authorization: token}\r\n      })\r\n\r\n      const deleteProduct = axios.delete(`/api/products/${id}`, {\r\n        headers: {Authorization: token}\r\n      })\r\n\r\n      await destroyImg\r\n      await deleteProduct\r\n      setCallback(!callback)\r\n      setLoading(false)\r\n    } catch (err) {\r\n      swal(\"Error\", err.response.data.msg, \"error\")\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <input type=\"checkbox\" id=\"sidebar-toggle\" />\r\n      <div className=\"sidebar\">\r\n        <div className=\"sidebar-header\">\r\n          <h3 className=\"brand\">\r\n            <span className=\"ti-unlink\"></span> \r\n            <span>ADMIN</span>\r\n          </h3> \r\n          <label htmlFor=\"sidebar-toggle\" className=\"ti-menu-alt\"></label>\r\n        </div>\r\n          \r\n        <div className=\"sidebar-menu\">\r\n          <ul>\r\n            <li>\r\n              <Link to=\"/admin\">\r\n                <span className=\"ti-home\"></span>\r\n                <span>Home</span>\r\n              </Link>\r\n            </li>\r\n            <li>\r\n              <Link to=\"/admin/create-product\">\r\n                <span className=\"ti-face-smile\"></span>\r\n                <span>Create Product</span>\r\n              </Link>\r\n            </li>\r\n            <li>\r\n              <Link to=\"/admin/create-category\">\r\n                <span className=\"ti-agenda\"></span>\r\n                <span>Create Category</span>\r\n              </Link>\r\n            </li>\r\n            <li>\r\n              <Link to=\"!#\">\r\n                <span className=\"ti-clipboard\"></span>\r\n                <span>Leaves</span>\r\n              </Link>\r\n            </li>\r\n            <li>\r\n              <Link to=\"!#\">\r\n                <span className=\"ti-folder\"></span>\r\n                <span>Projects</span>\r\n              </Link>\r\n            </li>\r\n            <li>\r\n              <Link to=\"!#\">\r\n                <span className=\"ti-time\"></span>\r\n                <span>Timesheet</span>\r\n              </Link>\r\n            </li>\r\n            <li>\r\n              <Link to=\"!#\">\r\n                <span className=\"ti-book\"></span>\r\n                <span>Contacts</span>\r\n              </Link>\r\n            </li>\r\n            <li>\r\n              <Link to=\"!#\">\r\n                <span className=\"ti-settings\"></span>\r\n                <span>Account</span>\r\n              </Link>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n      \r\n      <div className=\"main-content\">     \r\n        <header className=\"admin-header\">\r\n          <div className=\"search-wrapper\">\r\n            <span className=\"ti-search\"></span>\r\n            <input type=\"search\" placeholder=\"Search\" />\r\n          </div>\r\n          \r\n          <div className=\"social-icons\">\r\n            <span className=\"ti-bell\"></span>\r\n            <span className=\"ti-comment\"></span>\r\n            <div></div>\r\n          </div>\r\n        </header>\r\n          \r\n        \r\n      </div>\r\n    </div>\r\n  \r\n  )\r\n}\r\n\r\nexport default CreateProduct\r\n"]},"metadata":{},"sourceType":"module"}